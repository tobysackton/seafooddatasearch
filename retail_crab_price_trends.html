<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Retail Fresh Crab Average Price Trends (2020-2025) - Seafood Datasearch</title>
    <style>
        body {
            font-family: "Arial", sans-serif;
            background-color: #E0F2F1; /* Very light sea green */
            margin: 0;
            padding: 0;
        }
        
        header {
            padding: 20px;
            text-align: center;
            background-color: #B2DFDB; /* Slightly darker sea green for header */
        }
        
        .page-container {
            display: flex;
            min-height: calc(100vh - 200px); /* Adjust based on header and footer height */
        }
        
        .left-pane {
            flex: 1;
            padding: 20px;
            background-color: #E0F2F1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-right: 1px solid #B2DFDB;
        }
        
        .center-pane {
            flex: 2;
            padding: 20px;
            background-color: #FFFFFF;
            text-align: center;
        }
        
        .right-pane {
            flex: 1;
            padding: 20px;
            background-color: #E0F2F1;
            border-left: 1px solid #B2DFDB;
        }
        
        .logo {
            width: 90%;
            max-width: 300px;
            height: auto;
            margin-bottom: 20px;
        }
        
        .tagline {
            font-style: italic;
            color: #00796B;
            text-align: center;
        }
        
        .chart-content {
            background-color: #F5F5F5;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .nav-menu {
            background-color: #F5F5F5;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .nav-menu ul {
            list-style-type: none;
            padding: 0;
        }
        
        .nav-menu li {
            margin: 10px 0;
        }
        
        .nav-menu a {
            text-decoration: none;
            color: #00796B;
            font-weight: bold;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.3s;
            display: block;
        }
        
        .nav-menu a:hover {
            background-color: #B2DFDB;
        }
        
        .species-icons {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 20px;
            padding: 10px;
        }
        
        .species-icons img {
            width: 80px;
            height: auto;
        }
        
        footer {
            padding: 20px;
            background-color: #B2DFDB;
            text-align: center;
        }
        
        /* Chart container styles */
        #chart-container-wrapper {
            width: 100%;
            margin-top: 20px;
        }
        
        #price-chart-container {
            height: 500px;
            width: 100%;
        }
        
        /* Chart legend style */
        .chart-legend {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 15px;
            gap: 15px;
            padding: 10px;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            font-size: 14px;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 5px;
            border-radius: 3px;
        }
        
        .chart-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            text-align: center;
        }
        
        .insight-box {
            background-color: #E0F7FA;
            border-left: 4px solid #00BCD4;
            padding: 15px;
            margin: 20px 0;
            border-radius: 0 4px 4px 0;
            text-align: left;
        }
        
        .insight-title {
            font-weight: bold;
            margin-bottom: 8px;
            color: #00796B;
        }
        
        .negative {
            color: #D32F2F;
            font-weight: bold;
        }
        
        .positive {
            color: #388E3C;
            font-weight: bold;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .page-container {
                flex-direction: column;
            }
            
            .left-pane, .center-pane, .right-pane {
                width: 100%;
                border: none;
            }
            
            #price-chart-container {
                height: 300px;
            }
        }
    </style>
    
    <!-- Load Chart.js and PapaParse -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js"></script>
</head>
<body>
    <header>
        <h1>Seafood Datasearch</h1>
    </header>
    
    <div class="page-container">
        <!-- Left Pane - Logo and Tagline -->
        <div class="left-pane">
            <img src="assets/images/SD_Logo.png" alt="Seafood Datasearch Logo" class="logo">
            <div class="tagline">
                <h3>Market Analysis and Forecasts</h3>
                <p>Providing expert insights into the seafood industry.</p>
            </div>
        </div>
        
        <!-- Center Pane - Chart Content -->
        <div class="center-pane">
            <h2>Retail Fresh Crab Price Analysis (2020-2025)</h2>
            
            <!-- Chart 1: Average Price Trends -->
            <div class="chart-content">
                <h3>Monthly Average Price Trends (2020-2025)</h3>
                <p>This chart displays the monthly average price trends for fresh crab in retail, highlighting significant price fluctuations over the five-year period.</p>
                
                <div class="insight-box">
                    <div class="insight-title">Key Insight:</div>
                    <p>Average prices peaked in December 2021 at <span class="positive">$15.47/lb</span> before declining to <span class="negative">$8.10/lb</span> in April 2024, representing a <span class="negative">48%</span> decrease from peak pricing.</p>
                </div>
                
                <!-- Chart Container -->
                <div id="chart-container-wrapper">
                    <div class="chart-title">Retail Fresh Crab Monthly Average Price ($/lb)</div>
                    <div style="position: relative; height: 500px; width: 100%">
                        <canvas id="price-chart-container"></canvas>
                    </div>
                    <div id="price-chart-legend" class="chart-legend"></div>
                </div>
            </div>
            
            <div class="chart-content">
                <h3>About This Analysis</h3>
                <p>This analysis examines retail fresh crab pricing trends on a monthly basis from January 2020 through January 2025. The data reveals significant price volatility with a dramatic peak in late 2021 followed by substantial declines through 2023-2024.</p>
                <p>The price spike in 2021 coincided with supply chain disruptions and increased demand for at-home seafood consumption during pandemic restrictions. The subsequent price normalization reflects market adjustments, increasing supply availability, and changing consumer purchasing patterns.</p>
                <p>Data source: Retail Fresh Monthly Sales Data</p>
            </div>
        </div>
        
        <!-- Right Pane - Navigation -->
        <div class="right-pane">
            <div class="nav-menu">
                <h3>Navigation</h3>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="crab_charts.html">Crab Charts</a></li>
                    <li><a href="retail_fresh_crab_vol_month.html">Monthly Volume Trends</a></li>
                    <li><a href="retail_crab_price_trends.html">Price Trends</a></li>
                    <li><a href="retail_crab_price_elasticity.html">Price Elasticity</a></li>
                    <li><a href="retail_crab_december_price_elasticity.html">December Price Analysis</a></li>
                    <li><a href="seasonal_buying_patterns.html">Seasonal Patterns</a></li>
                    <li><a href="consumer_preferences_crab.html">Consumer Preferences</a></li>
                </ul>
            </div>
        </div>
    </div>
    
    <footer>
        <div class="species-icons">
            <img src="assets/images/Lobster_icon.png" alt="Lobster">
            <img src="assets/images/shrimp_icon.png" alt="Shrimp">
            <img src="assets/images/crab_icon.png" alt="Crab">
            <img src="assets/images/salmon_icon.png" alt="Salmon">
        </div>
        <p>&copy; 2025 Seafood Datasearch. All rights reserved.</p>
    </footer>
    
    <!-- Chart.js implementation -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Declare variables at higher scope
            let priceChart = null;
            
            // Check if required libraries are loaded
            if (!window.Chart || !window.Papa || !window._) {
                console.error('Missing libraries:', {
                    'Chart.js': !!window.Chart,
                    'PapaParse': !!window.Papa,
                    'Lodash': !!window._
                });
                return;
            }
            
            // Setup chart data
            setupCharts();
            
            function setupCharts() {
                try {
                    // Data for Monthly Average Price Trends 2020-2025
                    const monthlyPriceData = {
                        labels: ["Jan 20","Feb 20","Mar 20","Apr 20","May 20","Jun 20","Jul 20","Aug 20","Sep 20","Oct 20","Nov 20","Dec 20","Jan 21","Feb 21","Mar 21","Apr 21","May 21","Jun 21","Jul 21","Aug 21","Sep 21","Oct 21","Nov 21","Dec 21","Jan 22","Feb 22","Mar 22","Apr 22","May 22","Jun 22","Jul 22","Aug 22","Sep 22","Oct 22","Nov 22","Dec 22","Jan 23","Feb 23","Mar 23","Apr 23","May 23","Jun 23","Jul 23","Aug 23","Sep 23","Oct 23","Nov 23","Dec 23","Jan 24","Feb 24","Mar 24","Apr 24","May 24","Jun 24","Jul 24","Aug 24","Sep 24","Oct 24","Nov 24","Dec 24","Jan 25"],
                        datasets: [
                            {
                                label: 'Average Price ($/lb)',
                                data: [8.74,8.97,8.37,9.72,10.01,9.84,9.58,9.5,9.37,9.3,9.72,10.74,10.37,9.91,10.7,11.28,11.85,12.09,12.12,12.45,12.55,12.47,14.13,15.47,13.58,12.81,10.91,11.46,12.42,12.24,11.96,11.27,10.83,10.84,11.87,12.82,11.16,8.15,9.31,9.4,9.34,9.14,8.53,8.83,8.47,8.16,8.6,9.47,8.26,8.36,8.39,8.1,8.14,8.27,8.44,8.75,8.17,8.19,8.41,10.35,9.02],
                                backgroundColor: 'rgba(0, 121, 107, 0.1)',
                                borderColor: 'rgba(0, 121, 107, 1)',
                                borderWidth: 2,
                                tension: 0.1,
                                type: 'line',
                                fill: true,
                                pointBackgroundColor: 'rgba(0, 121, 107, 1)',
                                pointRadius: 4,
                                pointHoverRadius: 6
                            }
                        ]
                    };
                    
                    // Create the charts
                    createPriceChart(monthlyPriceData);
                } catch (err) {
                    console.error(`Error setting up charts: ${err.message}`);
                }
            }
            
            function createPriceChart(data) {
                const ctx = document.getElementById('price-chart-container').getContext('2d');
                
                // Clean up existing chart if it exists
                if (priceChart) {
                    priceChart.destroy();
                }
                
                // Create the chart
                priceChart = new Chart(ctx, {
                    type: 'line',
                    data: data,
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: false,
                                title: {
                                    display: true,
                                    text: 'Price ($/lb)'
                                },
                                min: 8.0, 
                                max: 16.0,
                                ticks: {
                                    callback: function(value) {
                                        return '$' + value.toFixed(2);
                                    }
                                }
                            },
                            x: {
                                title: {
                                    display: true,
                                    text: 'Month'
                                },
                                ticks: {
                                    maxRotation: 90,
                                    minRotation: 45,
                                    autoSkip: true,
                                    maxTicksLimit: 24
                                }
                            }
                        },
                        plugins: {
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.dataset.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed.y !== null) {
                                            label += '$' + context.parsed.y.toFixed(2);
                                        }
                                        return label;
                                    }
                                }
                            },
                            legend: {
                                display: false
                            }
                        }
                    }
                });
                
                // Create custom legend
                createCustomLegend(data, 'price-chart-legend');
            }
            
            function createCustomLegend(data, containerId) {
                const legendContainer = document.getElementById(containerId);
                legendContainer.innerHTML = '';
                
                data.datasets.forEach(dataset => {
                    const legendItem = document.createElement('div');
                    legendItem.className = 'legend-item';
                    
                    const colorBox = document.createElement('div');
                    colorBox.className = 'legend-color';
                    colorBox.style.backgroundColor = dataset.type === 'bar' ? 
                        dataset.backgroundColor : dataset.borderColor;
                    
                    const label = document.createElement('span');
                    label.textContent = dataset.label;
                    
                    legendItem.appendChild(colorBox);
                    legendItem.appendChild(label);
                    legendContainer.appendChild(legendItem);
                });
            }
        });
    </script>
</body>
</html>